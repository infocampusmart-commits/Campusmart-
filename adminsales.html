<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Admin Dashboard | Campusmart</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#f4f6f8;padding:20px}
h2{text-align:center}
.top{
  display:flex;
  gap:10px;
  margin-bottom:15px;
}
input{padding:8px;width:100%}
button{
  background:#0aa84f;
  color:white;
  border:none;
  padding:8px 12px;
  cursor:pointer;
}
table{
  width:100%;
  background:white;
  border-collapse:collapse;
}
th,td{
  border:1px solid #ddd;
  padding:10px;
  font-size:14px;
}
th{background:#0aa84f;color:white}
a{color:blue}
</style>
</head>

<body>

<script>
if(sessionStorage.getItem("adminAuth") !== "true"){
  window.location.href = "admin-login.html";
}
</script>

<h2>ðŸ›’ Campusmart Orders</h2>

<div class="top">
  <input id="search" placeholder="Search orders...">
  <button onclick="logout()">Logout</button>
</div>

<table>
<thead>
<tr>
<th>Date</th>
<th>Name</th>
<th>Email</th>
<th>Phone</th>
<th>Location</th>
<th>Product</th>
<th>Price</th>
<th>Receipt</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwWMLa6CRVdfb-0qWtwy2gvcEJMoyCILpgTE_bvIkWA8ra9xvmWpvhN8nqbtkw6YXTiSQ/exec";
let orders = [];

fetch(API_URL)
  .then(r => r.json())
  .then(data => {
    orders = data.reverse();
    render(orders);
  });

function render(list){
  tbody.innerHTML = "";
  list.forEach(o => {
    tbody.innerHTML += `
      <tr>
        <td>${o.Timestamp || ""}</td>
        <td>${o.Name || ""}</td>
        <td>${o.Email || ""}</td>
        <td>${o.Phone || ""}</td>
        <td>${o.Location || ""}</td>
        <td>${o.Product || ""}</td>
        <td>â‚¦${o.Price || ""}</td>
        <td><a href="${o.Receipt}" target="_blank">View</a></td>
      </tr>
    `;
  });
}

search.addEventListener("input", e => {
  const q = e.target.value.toLowerCase();
  render(
    orders.filter(o =>
      Object.values(o).join(" ").toLowerCase().includes(q)
    )
  );
});

function logout(){
  sessionStorage.removeItem("adminAuth");
  location.href="admin-login.html";
}
</script>

</body>
</html>

